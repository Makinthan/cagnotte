<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Cagnotte Anniversaire</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <button class="admin-btn" onclick="afficherAdmin()">üîë Acc√®s admin</button>
    <button id="logoutBtn" class="admin-btn" onclick="deconnexionAdmin()" style="display: none;">
      üö™ D√©connexion
    </button>  
    <h1>üéâ Cadeau pour l'anniversaire de Jen üéÇ</h1>
    <p id="description"> Coucou tout le monde ! Pour les 27 ans de Jen, elle a souhait√© avoir un nouveau sac (et oui encore üòÖ).<br />
      Donc comme l'ann√©e derni√®re je fais une cagnotte (je r√©cup√®re tout psq flemme de payer des frais aux plateformes) comme √ßa on peut le lui offrir (je compl√©terais le reste).
      Vous pourrez suivre l'avanc√© de la cagnotte ici et la liste des participants (mp moi si probl√®me)<br /><br />
      Merci √† tous pour votre participation üòÅ</p>
    <p>Model du sac : <a  href = "https://www.bhv.fr/p/sac+a+main+hobo+courage+28+en+cuir-coach/10179578/60" target="_blank"> Sac COACH</a><br />
    Couleur : Jaune (dispo seulement en boutique)</p>
    <h2>
      Montant r√©colt√© : <input id="montant" type="text" readonly> ‚Ç¨
      <button id="editBtn" onclick="modifierMontant()" style="display: none;">‚úèÔ∏è</button>
    </h2>
   
      <div id="progress-container">
        <div id="progress-bar"></div>
      </div>
      <p id="objectif-text">Objectif : 350 ‚Ç¨</p>
      <button class="participer" onclick="afficherPopup()">üíñ Je participe</button>
      <!-- Zone de texte des participants -->
      <div id="participants-section">
        <h3>Participants</h3>
        <textarea id="participants" placeholder="Liste des participants..." readonly></textarea>
      </div>
      
      <button id="editBtn" onclick="modifierMontant()" style="display: none;">‚úèÔ∏è</button>
    </div>

    
  </div>

  <!-- Pop-up -->
  <div id="popup" class="popup">
    <div class="popup-content">
      <span class="close" onclick="fermerPopup()">√ó</span>
      <h2>Participer √† la cagnotte</h2>
      <div class="paiement">
        <div>
          <h3>Via PayPal</h3>
          <img src="paypal-qr.png" alt="QR Code PayPal" class="qr">
        </div>
        <div>
          <h3>Ou via Wero</h3>
          <p>
            üì± <span id="numero">06 12 34 56 78</span>
            <button class="copy-button" onclick="copierNumero()">Copier</button>
          </p>
        </div>
        
      </div>
    </div>
  </div>

  <script>
    /*************/
    /*** JAVA ***/
    /*************/
    const OBJECTIF = 350;
    function mettreAJourProgressBar(montant) {
      const OBJECTIF = 500; // ou la valeur que tu veux
      const pourcentage = Math.min((parseFloat(montant) / OBJECTIF) * 100, 100);
      document.getElementById("progress-bar").style.width = pourcentage + "%";
    }

    // Afficher le montant sauvegard√© au chargement
    window.onload = function () {
      const saved = localStorage.getItem("montantCagnotte");
      if (saved) {
        document.getElementById("montant").value = saved;
        mettreAJourProgressBar(saved);
      }

      const participants = localStorage.getItem("listeParticipants");
      if (participants) {
        document.getElementById("participants").value = participants;
      }
  
      const adminActif = sessionStorage.getItem("adminConnecte");
      if (adminActif === "true") {
        document.getElementById("editBtn").style.display = "inline-block";
        document.getElementById("logoutBtn").style.display = "inline-block";
        document.getElementById("participants").removeAttribute("readonly");
      }
      else {
        document.getElementById("participants").setAttribute("readonly", true);
      }
    };
  
    function afficherPopup() {
      document.getElementById("popup").style.display = "flex";
    }
  
    function fermerPopup() {
      document.getElementById("popup").style.display = "none";
    }
  
    function modifierMontant() {
      const montantInput = document.getElementById("montant");
      const nouveau = prompt("Nouveau montant de la cagnotte :", montantInput.value);
      if (nouveau !== null && nouveau.trim() !== "") {
        montantInput.value = nouveau;
        localStorage.setItem("montantCagnotte", nouveau); // üíæ Sauvegarde
        mettreAJourProgressBar(nouveau);
      }
    }
  
    function afficherAdmin() {
      const motDePasse = prompt("Mot de passe admin :");
      if (motDePasse === "anniv2025") {
        sessionStorage.setItem("adminConnecte", "true");
        document.getElementById("editBtn").style.display = "inline-block";
        document.getElementById("logoutBtn").style.display = "inline-block";
        document.getElementById("participants").removeAttribute("readonly");
      } else {
        alert("Mot de passe incorrect.");
      }
    }


    function deconnexionAdmin() {
      sessionStorage.removeItem("adminConnecte");
      document.getElementById("editBtn").style.display = "none";
      document.getElementById("logoutBtn").style.display = "none";
      document.getElementById("participants").setAttribute("readonly", true);
      alert("D√©connect√© de l'admin.");
    }

    document.getElementById("participants")?.addEventListener("input", function () {
      if (!this.hasAttribute("readonly")) {
        localStorage.setItem("listeParticipants", this.value);
      }
    });

    function copierNumero() {
      const numero = document.getElementById("numero").innerText;
      const textarea = document.createElement("textarea");
      textarea.value = numero;
      document.body.appendChild(textarea);
      textarea.select();
      try {
        document.execCommand("copy");
        alert("Num√©ro copi√© !");
      } catch (err) {
        alert("La copie a √©chou√©.");
      }
      document.body.removeChild(textarea);
    }
  </script>
  
</body>
</html>
